.. index:: pair: class; ssh::Session
.. _doxid-classssh_1_1_session:

class ssh::Session
==================

.. toctree::
	:hidden:

Overview
~~~~~~~~

The :ref:`ssh::Session <doxid-classssh_1_1_session>` class contains the state of a SSH connection. :ref:`More...<details-classssh_1_1_session>`


.. ref-code-block:: cpp
	:class: doxyrest-overview-code-block

	#include <include/libssh/libsshpp.hpp>
	
	class Session {
	public:
		// construction
	
		:target:`~Session<doxid-classssh_1_1_session_1ae07d004bb4cee8a4c1a73f829363893d>`();

		// methods
	
		:ref:`Channel<doxid-classssh_1_1_channel>`*
		:ref:`acceptForward<doxid-classssh_1_1_session_1a6cd5318d71a3850a87b87bdfd89a5983>`(int timeout_ms);
	
		void
		:target:`cancelForward<doxid-classssh_1_1_session_1a9346912d769056b702f1d77eaf3f9b77>`(
			const char* address,
			int port
		);
	
		void
		:ref:`connect<doxid-classssh_1_1_session_1a2a88d7dd524e81cb9152a87cb6fefc40>`();
	
		void
		:ref:`disconnect<doxid-classssh_1_1_session_1aaa6972fe2757370a0cf2b90576eb6edc>`();
	
		int
		:ref:`getAuthList<doxid-classssh_1_1_session_1a08d70b5cdb5bd1a2a8f5f9ebbdf67b3b>`();
	
		const char*
		:ref:`getDisconnectMessage<doxid-classssh_1_1_session_1a4e0c0bcc2cc0d129e049b5b51bf1cbe8>`();
	
		const char*
		:target:`getError<doxid-classssh_1_1_session_1ab935e41beab3db33bccf5dd8f23a6886>`();
	
		int
		:target:`getErrorCode<doxid-classssh_1_1_session_1aa48f704e1f62335eef378efef5215257>`();
	
		std::string
		:ref:`getIssueBanner<doxid-classssh_1_1_session_1a9969ed8dcaccef321ac519271758b406>`();
	
		int
		:ref:`getOpensshVersion<doxid-classssh_1_1_session_1a9e0af590062a73a0927bb513bc19dd8e>`();
	
		:ref:`socket_t<doxid-libssh_8h_1a30353f381f5fccbb956eea1f3a110b6c>`
		:ref:`getSocket<doxid-classssh_1_1_session_1a30c021f6138124d785f151583e5656bd>`();
	
		int
		:ref:`getVersion<doxid-classssh_1_1_session_1a5d7b4df57ed97f2592893b0493336b88>`();
	
		int
		:ref:`isServerKnown<doxid-classssh_1_1_session_1a0b7055cb236685a9c18cb79c5492b40f>`();
	
		void
		:target:`listenForward<doxid-classssh_1_1_session_1a154c2a0e89631daf65b695f4c57b5bf5>`(
			const char* address,
			int port,
			int& boundport
		);
	
		void
		:target:`log<doxid-classssh_1_1_session_1a00ef8e842d49d238122cbdd3dece60a1>`(
			int priority,
			const char* format,
			...
		);
	
		void
		:ref:`optionsCopy<doxid-classssh_1_1_session_1a05cbc79d7b3ef14499fe258f56031957>`(const Session& source);
	
		void
		:ref:`optionsParseConfig<doxid-classssh_1_1_session_1a0fe8a68c45f9f150bb306ae840f68f0f>`(const char* file);
	
		void
		:ref:`setOption<doxid-classssh_1_1_session_1ad19ae4a0927094c12f383907cbf40ccc>`(
			enum :ref:`ssh_options_e<doxid-libssh_8h_1af7093adacb08e7ee1e9b16e9c8b0f46c>` type,
			const char* option
		);
	
		void
		:ref:`setOption<doxid-classssh_1_1_session_1ad6dc221d1212370608516c89115f6470>`(
			enum :ref:`ssh_options_e<doxid-libssh_8h_1af7093adacb08e7ee1e9b16e9c8b0f46c>` type,
			long int option
		);
	
		void
		:ref:`setOption<doxid-classssh_1_1_session_1a1bd14b987212698c146ed05f25454046>`(
			enum :ref:`ssh_options_e<doxid-libssh_8h_1af7093adacb08e7ee1e9b16e9c8b0f46c>` type,
			void* option
		);
	
		void
		:ref:`silentDisconnect<doxid-classssh_1_1_session_1a15b2a58607cc42628e17c94c8f7eb793>`();
	
		int
		:ref:`userauthNone<doxid-classssh_1_1_session_1a988398835fc131b0eb5a83a4adaec532>`();
	
		int
		:ref:`userauthPassword<doxid-classssh_1_1_session_1ac2d10826877bec6598961614eb62f0f7>`(const char* password);
	
		int
		:target:`userauthPrivatekeyFile<doxid-classssh_1_1_session_1a85c7eb65686658f2c23aa2a5e1e29edd>`(
			const char* filename,
			const char* passphrase
		);
	
		int
		:ref:`userauthPublickey<doxid-classssh_1_1_session_1a6dd49ee38bf24c31c5e0e28dc2af07b7>`(ssh_key privkey);
	
		int
		:ref:`userauthPublickeyAuto<doxid-classssh_1_1_session_1a651141f9bcf5792644f6d411ab2cc0c5>`(void);
	
		int
		:ref:`userauthTryPublickey<doxid-classssh_1_1_session_1afb635d7f84b000bbabb09a86ad5ad074>`(ssh_key pubkey);
	
		int
		:ref:`writeKnownhost<doxid-classssh_1_1_session_1ae55f054025dcbe4ceeaec87c9ca064c7>`();
	};
.. _details-classssh_1_1_session:

Detailed Documentation
~~~~~~~~~~~~~~~~~~~~~~

The :ref:`ssh::Session <doxid-classssh_1_1_session>` class contains the state of a SSH connection.

Methods
-------

.. index:: pair: function; acceptForward
.. _doxid-classssh_1_1_session_1a6cd5318d71a3850a87b87bdfd89a5983:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`Channel<doxid-classssh_1_1_channel>`*
	acceptForward(int timeout_ms)

accept an incoming forward connection

.. warning::

	you have to delete this pointer after use



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- timeout_ms

		- timeout for waiting, in ms



.. rubric:: Returns:

new :ref:`Channel <doxid-classssh_1_1_channel>` pointer on the forward connection

NULL in case of error



.. rubric:: See also:

ssh_channel_forward_accept

:ref:`Session::listenForward <doxid-classssh_1_1_session_1a154c2a0e89631daf65b695f4c57b5bf5>`

.. index:: pair: function; connect
.. _doxid-classssh_1_1_session_1a2a88d7dd524e81cb9152a87cb6fefc40:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	connect()

connects to the remote host



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- :ref:`SshException <doxid-classssh_1_1_ssh_exception>`

		- on error



.. rubric:: See also:

:ref:`ssh_connect <doxid-group__libssh__session_1ga032e07cbd8bc3f14cb2dd375db0b03d7>`

.. index:: pair: function; disconnect
.. _doxid-classssh_1_1_session_1aaa6972fe2757370a0cf2b90576eb6edc:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	disconnect()

Disconnects from the SSH server and closes connection.



.. rubric:: See also:

:ref:`ssh_disconnect <doxid-group__libssh__session_1ga0f048a4c0dbe02cfb7e9c5b6d0db0f27>`

.. index:: pair: function; getAuthList
.. _doxid-classssh_1_1_session_1a08d70b5cdb5bd1a2a8f5f9ebbdf67b3b:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	int
	getAuthList()

Returns the available authentication methods from the server.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- :ref:`SshException <doxid-classssh_1_1_ssh_exception>`

		- on error



.. rubric:: Returns:

Bitfield of available methods.



.. rubric:: See also:

:ref:`ssh_userauth_list <doxid-group__libssh__auth_1ga35d44897a44b4bb3b7c01108c1812a37>`

.. index:: pair: function; getDisconnectMessage
.. _doxid-classssh_1_1_session_1a4e0c0bcc2cc0d129e049b5b51bf1cbe8:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	const char*
	getDisconnectMessage()

Returns the disconnect message from the server, if any.



.. rubric:: Returns:

pointer to the message, or NULL. Do not attempt to free the pointer.

.. index:: pair: function; getIssueBanner
.. _doxid-classssh_1_1_session_1a9969ed8dcaccef321ac519271758b406:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	std::string
	getIssueBanner()

gets the Issue banner from the ssh server



.. rubric:: Returns:

the issue banner. This is generally a MOTD from server



.. rubric:: See also:

:ref:`ssh_get_issue_banner <doxid-group__libssh__session_1ga89864d4d5cc6d3d6ef1c39652f2a688f>`

.. index:: pair: function; getOpensshVersion
.. _doxid-classssh_1_1_session_1a9e0af590062a73a0927bb513bc19dd8e:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	int
	getOpensshVersion()

returns the OpenSSH version (server) if possible



.. rubric:: Returns:

openssh version code



.. rubric:: See also:

:ref:`ssh_get_openssh_version <doxid-group__libssh__session_1gac55d2895467a1e898ee75b4710d836a5>`

.. index:: pair: function; getSocket
.. _doxid-classssh_1_1_session_1a30c021f6138124d785f151583e5656bd:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`socket_t<doxid-libssh_8h_1a30353f381f5fccbb956eea1f3a110b6c>`
	getSocket()

returns the file descriptor used for the communication

.. warning::

	if a proxycommand is used, this function will only return one of the two file descriptors being used



.. rubric:: Returns:

the file descriptor



.. rubric:: See also:

:ref:`ssh_get_fd <doxid-group__libssh__session_1gafe509fcea47714b5cd277d1e35e83276>`

.. index:: pair: function; getVersion
.. _doxid-classssh_1_1_session_1a5d7b4df57ed97f2592893b0493336b88:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	int
	getVersion()

returns the version of the SSH protocol being used



.. rubric:: Returns:

the SSH protocol version



.. rubric:: See also:

:ref:`ssh_get_version <doxid-group__libssh__session_1ga8467735e4735165336f68ee82e24de0e>`

.. index:: pair: function; isServerKnown
.. _doxid-classssh_1_1_session_1a0b7055cb236685a9c18cb79c5492b40f:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	int
	isServerKnown()

verifies that the server is known



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- :ref:`SshException <doxid-classssh_1_1_ssh_exception>`

		- on error



.. rubric:: Returns:

Integer value depending on the knowledge of the server key



.. rubric:: See also:

:ref:`ssh_is_server_known <doxid-group__libssh__session_1ga6f37e3d7bb6b938b44d6a34a76fdfa0b>`

.. index:: pair: function; optionsCopy
.. _doxid-classssh_1_1_session_1a05cbc79d7b3ef14499fe258f56031957:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	optionsCopy(const Session& source)

copies options from a session to another



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- :ref:`SshException <doxid-classssh_1_1_ssh_exception>`

		- on error



.. rubric:: See also:

:ref:`ssh_options_copy <doxid-group__libssh__session_1gaead8cef1f39e785139bc510852ce1dff>`

.. index:: pair: function; optionsParseConfig
.. _doxid-classssh_1_1_session_1a0fe8a68c45f9f150bb306ae840f68f0f:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	optionsParseConfig(const char* file)

parses a configuration file for options



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- :ref:`SshException <doxid-classssh_1_1_ssh_exception>`

		- on error

	*
		- file

		- configuration file name



.. rubric:: See also:

:ref:`ssh_options_parse_config <doxid-group__libssh__session_1ga82371e723260c7572ea061edecc2e9f1>`

.. index:: pair: function; setOption
.. _doxid-classssh_1_1_session_1ad19ae4a0927094c12f383907cbf40ccc:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	setOption(
		enum :ref:`ssh_options_e<doxid-libssh_8h_1af7093adacb08e7ee1e9b16e9c8b0f46c>` type,
		const char* option
	)

sets an SSH session options



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- type

		- Type of option

	*
		- option

		- cstring containing the value of option

	*
		- :ref:`SshException <doxid-classssh_1_1_ssh_exception>`

		- on error



.. rubric:: See also:

:ref:`ssh_options_set <doxid-group__libssh__session_1ga7a801b85800baa3f4e16f5b47db0a73d>`

.. index:: pair: function; setOption
.. _doxid-classssh_1_1_session_1ad6dc221d1212370608516c89115f6470:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	setOption(
		enum :ref:`ssh_options_e<doxid-libssh_8h_1af7093adacb08e7ee1e9b16e9c8b0f46c>` type,
		long int option
	)

sets an SSH session options



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- type

		- Type of option

	*
		- option

		- long integer containing the value of option

	*
		- :ref:`SshException <doxid-classssh_1_1_ssh_exception>`

		- on error



.. rubric:: See also:

:ref:`ssh_options_set <doxid-group__libssh__session_1ga7a801b85800baa3f4e16f5b47db0a73d>`

.. index:: pair: function; setOption
.. _doxid-classssh_1_1_session_1a1bd14b987212698c146ed05f25454046:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	setOption(
		enum :ref:`ssh_options_e<doxid-libssh_8h_1af7093adacb08e7ee1e9b16e9c8b0f46c>` type,
		void* option
	)

sets an SSH session options



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- type

		- Type of option

	*
		- option

		- void pointer containing the value of option

	*
		- :ref:`SshException <doxid-classssh_1_1_ssh_exception>`

		- on error



.. rubric:: See also:

:ref:`ssh_options_set <doxid-group__libssh__session_1ga7a801b85800baa3f4e16f5b47db0a73d>`

.. index:: pair: function; silentDisconnect
.. _doxid-classssh_1_1_session_1a15b2a58607cc42628e17c94c8f7eb793:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	silentDisconnect()

silently disconnect from remote host



.. rubric:: See also:

:ref:`ssh_silent_disconnect <doxid-group__libssh__session_1gae1bd16255ba373325adf76307d0c8c42>`

.. index:: pair: function; userauthNone
.. _doxid-classssh_1_1_session_1a988398835fc131b0eb5a83a4adaec532:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	int
	userauthNone()

Authenticates using the "none" method.

Prefer using autopubkey if possible.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- :ref:`SshException <doxid-classssh_1_1_ssh_exception>`

		- on error



.. rubric:: Returns:

SSH_AUTH_SUCCESS, SSH_AUTH_PARTIAL, SSH_AUTH_DENIED



.. rubric:: See also:

:ref:`ssh_userauth_none <doxid-group__libssh__auth_1ga58e7c265236edbc97a2f117d3f23b4dd>`

Session::userauthAutoPubkey

.. index:: pair: function; userauthPassword
.. _doxid-classssh_1_1_session_1ac2d10826877bec6598961614eb62f0f7:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	int
	userauthPassword(const char* password)

Authenticates using the password method.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- password

		- password to use for authentication

	*
		- :ref:`SshException <doxid-classssh_1_1_ssh_exception>`

		- on error



.. rubric:: Returns:

SSH_AUTH_SUCCESS, SSH_AUTH_PARTIAL, SSH_AUTH_DENIED



.. rubric:: See also:

:ref:`ssh_userauth_password <doxid-group__libssh__auth_1ga50c0c150f8c4703e7ee49b3e3e3ca215>`

.. index:: pair: function; userauthPublickey
.. _doxid-classssh_1_1_session_1a6dd49ee38bf24c31c5e0e28dc2af07b7:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	int
	userauthPublickey(ssh_key privkey)

Authenticates using the publickey method.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- privkey

		- private key to use for authentication

	*
		- :ref:`SshException <doxid-classssh_1_1_ssh_exception>`

		- on error



.. rubric:: Returns:

SSH_AUTH_SUCCESS, SSH_AUTH_PARTIAL, SSH_AUTH_DENIED



.. rubric:: See also:

:ref:`ssh_userauth_pubkey <doxid-legacy_8c_1a18f0c63c75b9af6c28c032e93628a7c5>`

.. index:: pair: function; userauthPublickeyAuto
.. _doxid-classssh_1_1_session_1a651141f9bcf5792644f6d411ab2cc0c5:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	int
	userauthPublickeyAuto(void)

Authenticates automatically using public key.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- :ref:`SshException <doxid-classssh_1_1_ssh_exception>`

		- on error



.. rubric:: Returns:

SSH_AUTH_SUCCESS, SSH_AUTH_PARTIAL, SSH_AUTH_DENIED



.. rubric:: See also:

:ref:`ssh_userauth_autopubkey <doxid-legacy_8c_1ad07655f2c742ce68271422197cf2acda>`

.. index:: pair: function; userauthTryPublickey
.. _doxid-classssh_1_1_session_1afb635d7f84b000bbabb09a86ad5ad074:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	int
	userauthTryPublickey(ssh_key pubkey)

Try to authenticate using the publickey method.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- pubkey

		- public key to use for authentication

	*
		- :ref:`SshException <doxid-classssh_1_1_ssh_exception>`

		- on error



.. rubric:: Returns:

SSH_AUTH_SUCCESS if the pubkey is accepted,

SSH_AUTH_DENIED if the pubkey is denied



.. rubric:: See also:

ssh_userauth_try_pubkey

.. index:: pair: function; writeKnownhost
.. _doxid-classssh_1_1_session_1ae55f054025dcbe4ceeaec87c9ca064c7:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	int
	writeKnownhost()

Writes the known host file with current host key.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- :ref:`SshException <doxid-classssh_1_1_ssh_exception>`

		- on error



.. rubric:: See also:

:ref:`ssh_write_knownhost <doxid-group__libssh__session_1gaf61a9cfdc40c76ffce9f9a8543755d36>`

