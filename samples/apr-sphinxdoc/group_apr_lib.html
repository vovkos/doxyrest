<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>General Purpose Library Routines &#8212; Apache Portable Runtime Documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/sphinxdoc.css?v=34905f61" />
    <link rel="stylesheet" type="text/css" href="_static/doxyrest-pygments.css?v=ff3f4257" />
    <link rel="stylesheet" type="text/css" href="_static/doxyrest-sphinxdoc.css?v=3785b6ce" />
    <script src="_static/documentation_options.js?v=73275c37"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/target-highlight.js?v=df7d332b"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="struct apr_vformatter_buff_t" href="struct_apr_vformatter_buff_t.html" />
    <link rel="prev" title="Functions for manipulating the environment" href="group_apr_env.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="struct_apr_vformatter_buff_t.html" title="struct apr_vformatter_buff_t"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="group_apr_env.html" title="Functions for manipulating the environment"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Apache Portable Runtime Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="group_APR.html" accesskey="U">Apache Portability Runtime library</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">General Purpose Library Routines</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="general-purpose-library-routines">
<span id="doxid-group-apr-lib"></span><span id="index-0"></span><h1>General Purpose Library Routines</h1>
<div class="toctree-wrapper compound">
</div>
<section id="overview">
<h2>Overview</h2>
<p>This is collection of oddballs that didn’t fit anywhere else, and might move to more appropriate headers with the release of APR 1.0. <a class="reference internal" href="#details-group-apr-lib"><span class="std std-ref">More…</span></a></p>
<pre class="highlight doxyrest-overview-code-block literal-block"><span></span><span class="c1">// typedefs</span>

<span class="k">typedef</span> <span class="k">struct</span> <a class="reference internal" href="struct_apr_vformatter_buff_t.html#doxid-structapr-vformatter-buff-t"><span class="std std-ref">apr_vformatter_buff_t</span></a><span></span> <a class="reference internal" href="#doxid-group-apr-lib-1ga5e9986deebda40f2d1cf8364fa03c3c5"><span class="std std-ref">apr_vformatter_buff_t</span></a><span></span><span class="p">;</span>

<span class="c1">// structs</span>

<span class="k">struct</span> <a class="reference internal" href="struct_apr_vformatter_buff_t.html#doxid-structapr-vformatter-buff-t"><span class="std std-ref">apr_vformatter_buff_t</span></a><span></span><span class="p">;</span>

<span class="c1">// global functions</span>

<span class="k">const</span> <span class="kt">char</span><span class="o">*</span>
<a class="reference internal" href="#doxid-group-apr-lib-1ga241e929df23aede34eb3f2651cf56bc9"><span class="std std-ref">apr_filepath_name_get</span></a><span></span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">pathname</span><span class="p">);</span>

<span class="kt">int</span>
<a class="reference internal" href="#doxid-group-apr-lib-1gad2cd3594aeaafd45931d1034965f48c1"><span class="std std-ref">apr_vformatter</span></a><span></span><span class="p">(</span>
    <span class="kt">int</span><span class="p">(</span><span class="o">*</span><span class="p">)(</span><a class="reference internal" href="struct_apr_vformatter_buff_t.html#doxid-structapr-vformatter-buff-t"><span class="std std-ref">apr_vformatter_buff_t</span></a><span></span><span class="o">*</span><span class="n">b</span><span class="p">)</span> <span class="n">flush_func</span><span class="p">,</span>
    <a class="reference internal" href="struct_apr_vformatter_buff_t.html#doxid-structapr-vformatter-buff-t"><span class="std std-ref">apr_vformatter_buff_t</span></a><span></span><span class="o">*</span> <span class="n">c</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">fmt</span><span class="p">,</span>
    <span class="kt">va_list</span> <span class="n">ap</span>
<span class="p">);</span>

<a class="reference internal" href="group_apr_errno.html#doxid-group-apr-errno-1gaf76ee4543247e9fb3f3546203e590a6c"><span class="std std-ref">apr_status_t</span></a><span></span>
<a class="reference internal" href="#doxid-group-apr-lib-1ga377e0677598745769ec6f80fecf8f859"><span class="std std-ref">apr_password_get</span></a><span></span><span class="p">(</span>
    <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">prompt</span><span class="p">,</span>
    <span class="kt">char</span><span class="o">*</span> <span class="n">pwbuf</span><span class="p">,</span>
    <span class="n">apr_size_t</span><span class="o">*</span> <span class="n">bufsize</span>
<span class="p">);</span>

<span class="c1">// macros</span>

<span class="cp">#define </span><a class="reference internal" href="#doxid-group-apr-lib-1ga0c9dd98f46b90b5bcd4cbf75e252d0da"><span class="std std-ref">HUGE_STRING_LEN</span></a><span></span>

<span class="cp">#define </span><a class="reference internal" href="#doxid-group-apr-lib-1gaa3b0264aadbd9f8d805252fb1ca1cd0e"><span class="std std-ref">apr_killpg</span></a><span></span><span class="p">(</span> \
    <span class="n">x</span><span class="p">,</span> \
    <span class="n">y</span> \
<span class="p">)</span></pre>
</section>
<section id="detailed-documentation">
<span id="details-group-apr-lib"></span><h2>Detailed Documentation</h2>
<p>This is collection of oddballs that didn’t fit anywhere else, and might move to more appropriate headers with the release of APR 1.0.</p>
<section id="typedefs">
<h3>Typedefs</h3>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-group-apr-lib-1ga5e9986deebda40f2d1cf8364fa03c3c5"><span id="index-1"></span><span></span><span class="k">typedef</span> <span class="k">struct</span> <a class="reference internal" href="struct_apr_vformatter_buff_t.html#doxid-structapr-vformatter-buff-t"><span class="std std-ref">apr_vformatter_buff_t</span></a><span></span> <span class="n">apr_vformatter_buff_t</span></pre>
<p class="rubric">See also:</p>
<p><a class="reference internal" href="struct_apr_vformatter_buff_t.html#doxid-structapr-vformatter-buff-t"><span class="std std-ref">apr_vformatter_buff_t</span></a></p>
</section>
<section id="global-functions">
<h3>Global Functions</h3>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-group-apr-lib-1ga241e929df23aede34eb3f2651cf56bc9"><span id="index-2"></span><span></span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span>
<span class="n">apr_filepath_name_get</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">pathname</span><span class="p">)</span></pre>
<p>return the final element of the pathname.. code-block:: none</p>
<blockquote>
<div><dl class="simple">
<dt>For example:</dt><dd><p>“/foo/bar/gum”    -&gt; “gum”
“/foo/bar/gum/”   -&gt; “”
“gum”             -&gt; “gum”
“bs\path\stuff” -&gt; “stuff”</p>
</dd>
</dl>
</div></blockquote>
<p class="rubric">Parameters:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>pathname</p></td>
<td><p>The path to get the final element of</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Returns:</p>
<p>the final element of the path</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-group-apr-lib-1gad2cd3594aeaafd45931d1034965f48c1"><span id="index-3"></span><span></span><span class="kt">int</span>
<span class="n">apr_vformatter</span><span class="p">(</span>
    <span class="kt">int</span><span class="p">(</span><span class="o">*</span><span class="p">)(</span><a class="reference internal" href="struct_apr_vformatter_buff_t.html#doxid-structapr-vformatter-buff-t"><span class="std std-ref">apr_vformatter_buff_t</span></a><span></span><span class="o">*</span><span class="n">b</span><span class="p">)</span> <span class="n">flush_func</span><span class="p">,</span>
    <a class="reference internal" href="struct_apr_vformatter_buff_t.html#doxid-structapr-vformatter-buff-t"><span class="std std-ref">apr_vformatter_buff_t</span></a><span></span><span class="o">*</span> <span class="n">c</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">fmt</span><span class="p">,</span>
    <span class="kt">va_list</span> <span class="n">ap</span>
<span class="p">)</span></pre>
<p><a class="reference internal" href="#doxid-group-apr-lib-1gad2cd3594aeaafd45931d1034965f48c1"><span class="std std-ref">apr_vformatter()</span></a> is a generic printf-style formatting routine with some extensions… code-block:: none</p>
<blockquote>
<div><p>The extensions are:</p>
</div></blockquote>
<ul>
<li><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>%pA takes a struct in_addr *, and prints it as a.b.c.d
</pre></div>
</div>
</li>
<li><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>%pI takes an :ref:`apr_sockaddr_t &lt;doxid-structapr__sockaddr__t&gt;` * and prints it as a.b.c.d:port or
[ipv6-address]:port
</pre></div>
</div>
</li>
<li><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>%pT takes an apr_os_thread_t * and prints it in decimal
(&#39;0&#39; is printed if !APR_HAS_THREADS)
</pre></div>
</div>
</li>
<li><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>%pt takes an apr_os_thread_t * and prints it in hexadecimal
(&#39;0&#39; is printed if !APR_HAS_THREADS)
</pre></div>
</div>
</li>
<li><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>%pm takes an apr_status_t * and prints the appropriate error
string (from apr_strerror) corresponding to that error code.
</pre></div>
</div>
</li>
<li><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>%pp takes a void * and outputs it in hex
</pre></div>
</div>
</li>
<li><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>%pB takes a apr_uint32_t * as bytes and outputs it&#39;s apr_strfsize
</pre></div>
</div>
</li>
<li><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>%pF same as above, but takes a apr_off_t *
</pre></div>
</div>
</li>
<li><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>%pS same as above, but takes a apr_size_t *
</pre></div>
</div>
</li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>%pA, %pI, %pT, %pp are available from APR 1.0.0 onwards (and in 0.9.x).
%pt is only available from APR 1.2.0 onwards.
%pm, %pB, %pF and %pS are only available from APR 1.3.0 onwards.
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The %p hacks are to force gcc&#39;s printf warning code to skip
over a pointer argument without complaining.  This does
mean that the ANSI-style %p (output a void * in hex format) won&#39;t
work as expected at all, but that seems to be a fair trade-off
for the increased robustness of having printf-warnings work.
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Additionally, apr_vformatter allows for arbitrary output methods
using the apr_vformatter_buff and flush_func.
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The apr_vformatter_buff has two elements curpos and endpos.
curpos is where apr_vformatter will write the next byte of output.
It proceeds writing output to curpos, and updating curpos, until
either the end of output is reached, or curpos == endpos (i.e. the
buffer is full).
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>If the end of output is reached, apr_vformatter returns the
number of bytes written.
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>When the buffer is full, the flush_func is called.  The flush_func
can return -1 to indicate that no further output should be attempted,
and apr_vformatter will return immediately with -1.  Otherwise
the flush_func should flush the buffer in whatever manner is
appropriate, re apr_pool_t nitialize curpos and endpos, and return 0.
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Note that flush_func is only invoked as a result of attempting to
write another byte at curpos when curpos &gt;= endpos.  So for
example, it&#39;s possible when the output exactly matches the buffer
space available that curpos == endpos will be true when
apr_vformatter returns.
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>apr_vformatter does not call out to any other code, it is entirely
self-contained.  This allows the callers to do things which are
otherwise &quot;unsafe&quot;.  For example, apr_psprintf uses the &quot;scratch&quot;
space at the unallocated end of a block, and doesn&#39;t actually
complete the allocation until apr_vformatter returns.  apr_psprintf
would be completely broken if apr_vformatter were to call anything
that used this same pool.  Similarly http_bprintf() uses the &quot;scratch&quot;
space at the end of its output buffer, and doesn&#39;t actually note
that the space is in use until it either has to flush the buffer
or until apr_vformatter returns.
</pre></div>
</div>
<p class="rubric">Parameters:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>flush_func</p></td>
<td><p>The function to call when the buffer is full</p></td>
</tr>
<tr class="row-even"><td><p>c</p></td>
<td><p>The buffer to write to</p></td>
</tr>
<tr class="row-odd"><td><p>fmt</p></td>
<td><p>The format string</p></td>
</tr>
<tr class="row-even"><td><p>ap</p></td>
<td><p>The arguments to use to fill out the format string.</p></td>
</tr>
</tbody>
</table>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-group-apr-lib-1ga377e0677598745769ec6f80fecf8f859"><span id="index-4"></span><a class="reference internal" href="group_apr_errno.html#doxid-group-apr-errno-1gaf76ee4543247e9fb3f3546203e590a6c"><span class="std std-ref">apr_status_t</span></a><span></span>
<span class="n">apr_password_get</span><span class="p">(</span>
    <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">prompt</span><span class="p">,</span>
    <span class="kt">char</span><span class="o">*</span> <span class="n">pwbuf</span><span class="p">,</span>
    <span class="n">apr_size_t</span><span class="o">*</span> <span class="n">bufsize</span>
<span class="p">)</span></pre>
<p>Display a prompt and read in the password from stdin. If the password entered must be truncated to fit in the provided buffer, APR_ENAMETOOLONG will be returned. Note that the bufsize paramater is passed by reference for no reason; its value will never be modified by the <a class="reference internal" href="#doxid-group-apr-lib-1ga377e0677598745769ec6f80fecf8f859"><span class="std std-ref">apr_password_get()</span></a> function.</p>
<p class="rubric">Parameters:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>prompt</p></td>
<td><p>The prompt to display</p></td>
</tr>
<tr class="row-even"><td><p>pwbuf</p></td>
<td><p>Buffer to store the password</p></td>
</tr>
<tr class="row-odd"><td><p>bufsize</p></td>
<td><p>The length of the password buffer.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="macros">
<h3>Macros</h3>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-group-apr-lib-1ga0c9dd98f46b90b5bcd4cbf75e252d0da"><span id="index-5"></span><span></span><span class="cp">#define HUGE_STRING_LEN</span></pre>
<p>A constant representing a ‘large’ string.</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-group-apr-lib-1gaa3b0264aadbd9f8d805252fb1ca1cd0e"><span id="index-6"></span><span></span><span class="cp">#define apr_killpg( \</span>
<span class="cp">    x, \</span>
<span class="cp">    y \</span>
<span class="cp">)</span></pre>
<p>apr_killpg Small utility macros to make things easier to read. Not usually a goal, to be sure..</p>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">General Purpose Library Routines</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#detailed-documentation">Detailed Documentation</a><ul>
<li><a class="reference internal" href="#typedefs">Typedefs</a></li>
<li><a class="reference internal" href="#global-functions">Global Functions</a></li>
<li><a class="reference internal" href="#macros">Macros</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="group_apr_env.html"
                          title="previous chapter">Functions for manipulating the environment</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="struct_apr_vformatter_buff_t.html"
                          title="next chapter">struct apr_vformatter_buff_t</a></p>
  </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="struct_apr_vformatter_buff_t.html" title="struct apr_vformatter_buff_t"
             >next</a> |</li>
        <li class="right" >
          <a href="group_apr_env.html" title="Functions for manipulating the environment"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Apache Portable Runtime Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="group_APR.html" >Apache Portability Runtime library</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">General Purpose Library Routines</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2008-2017, Apache Portable Runtime Maintainers.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>