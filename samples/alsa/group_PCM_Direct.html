

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Direct Access (MMAP) Functions &mdash; ALSA Library Documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/doxyrest-pygments.css?v=ff3f4257" />
      <link rel="stylesheet" type="text/css" href="_static/doxyrest-sphinx_rtd_theme.css?v=b6ca47bd" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=cb7bf70b"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/target-highlight.js?v=df7d332b"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Format Mask Functions" href="group_PCM_Format.html" />
    <link rel="prev" title="Description Functions" href="group_PCM_Description.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            ALSA Library Documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="group_Config.html">Configuration Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_Digital_Audio_Interface.html">Constants for Digital Audio Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_MIDI_Interface.html">Constants for MIDI v1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_Control.html">Control Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_Error.html">Error handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_CtlPlugin_SDK.html">External Control Plugin SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_Plugin_SDK.html">External PCM plugin SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_Global.html">Global defines and functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_HwDep.html">Hardware Dependant Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_Input.html">Input Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_Sequencer.html">MIDI Sequencer</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_Mixer.html">Mixer Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_Output.html">Output Interface</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="group_PCM.html">PCM Interface</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="group_PCM_Access.html">Access Mask Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_PCM_Dump.html">Debug Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_PCM_Deprecated.html">Deprecated Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_PCM_Description.html">Description Functions</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Direct Access (MMAP) Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#detailed-documentation">Detailed Documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#global-functions">Global Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="group_PCM_Format.html">Format Mask Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_PCM_HW_Params.html">Hardware Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_PCM_Helpers.html">Helper Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_PCM_Hook.html">Hook Extension</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_PCM_Scope.html">Scope Plugin Extension</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_PCM_Simple.html">Simple setup functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_PCM_SW_Params.html">Software Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_PCM_Status.html">Status Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_PCM_Info.html">Stream Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_PCM_SubFormat.html">Subformat Mask Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="enum__snd_pcm_type.html">enum _snd_pcm_type</a></li>
<li class="toctree-l2"><a class="reference internal" href="enum_snd_pcm_access_t.html">enum snd_pcm_access_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="enum_snd_pcm_chmap_position.html">enum snd_pcm_chmap_position</a></li>
<li class="toctree-l2"><a class="reference internal" href="enum_snd_pcm_chmap_type.html">enum snd_pcm_chmap_type</a></li>
<li class="toctree-l2"><a class="reference internal" href="enum_snd_pcm_class_t.html">enum snd_pcm_class_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="enum_snd_pcm_format_t.html">enum snd_pcm_format_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="enum_snd_pcm_start_t.html">enum snd_pcm_start_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="enum_snd_pcm_state_t.html">enum snd_pcm_state_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="enum_snd_pcm_stream_t.html">enum snd_pcm_stream_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="enum_snd_pcm_subclass_t.html">enum snd_pcm_subclass_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="enum_snd_pcm_subformat_t.html">enum snd_pcm_subformat_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="enum_snd_pcm_tstamp_t.html">enum snd_pcm_tstamp_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="enum_snd_pcm_tstamp_type_t.html">enum snd_pcm_tstamp_type_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="enum_snd_pcm_xrun_t.html">enum snd_pcm_xrun_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="struct_snd_pcm_audio_tstamp_config_t.html">struct snd_pcm_audio_tstamp_config_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="struct_snd_pcm_audio_tstamp_report_t.html">struct snd_pcm_audio_tstamp_report_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="struct_snd_pcm_channel_area_t.html">struct snd_pcm_channel_area_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="struct_snd_pcm_chmap_query_t.html">struct snd_pcm_chmap_query_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="struct_snd_pcm_chmap_t.html">struct snd_pcm_chmap_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="union_snd_pcm_sync_id_t.html">union snd_pcm_sync_id_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_PCM.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_PCM.html#detailed-documentation">Detailed Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="group_RawMidi.html">RawMidi Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_Timer.html">Timer Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_topology.html">Topology Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_ucm.html">Use Case Interface</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="page_topology.html">ALSA Topology Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_Usecase.html">ALSA Use Case Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_bug.html">Bug List</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_conf.html">Configuration files</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_control.html">Control interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_deprecated.html">Deprecated List</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_ctl_external_plugins.html">External Control Plugin SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_hcontrol.html">High level control interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_confhooks.html">Hooks in configuration files</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_mixer.html">Mixer interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_pcm.html">PCM (digital audio) interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_pcm_plugins.html">PCM (digital audio) plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_pcm_external_plugins.html">PCM External Plugin SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_rawmidi.html">RawMidi interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_confarg.html">Runtime arguments in configuration files</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_conffunc.html">Runtime functions in configuration files</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_seq.html">Sequencer interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_timer.html">Timer interface</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="example__test_latency.c.html">/test/latency.c</a></li>
<li class="toctree-l1"><a class="reference internal" href="example__test_pcm.c.html">/test/pcm.c</a></li>
<li class="toctree-l1"><a class="reference internal" href="example__test_pcm_min.c.html">/test/pcm_min.c</a></li>
<li class="toctree-l1"><a class="reference internal" href="example__test_rawmidi.c.html">/test/rawmidi.c</a></li>
<li class="toctree-l1"><a class="reference internal" href="example__test_timer.c.html">/test/timer.c</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="global.html">Global Namespace</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ALSA Library Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="group_PCM.html">PCM Interface</a></li>
      <li class="breadcrumb-item active">Direct Access (MMAP) Functions</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="direct-access-mmap-functions">
<span id="doxid-group-p-c-m-direct"></span><span id="index-0"></span><h1>Direct Access (MMAP) Functions</h1>
<div class="toctree-wrapper compound">
</div>
<section id="overview">
<h2>Overview</h2>
<p>See the <a class="reference internal" href="page_pcm.html#doxid-pcm"><span class="std std-ref">PCM (digital audio) interface</span></a> page for more details. <a class="reference internal" href="#details-group-p-c-m-direct"><span class="std std-ref">More…</span></a></p>
<pre class="highlight doxyrest-overview-code-block literal-block"><span></span><span class="c1">// global functions</span>

<span class="kt">int</span>
<a class="reference internal" href="#doxid-group-p-c-m-direct-1ga6d4acf42de554d4d1177fb035d484ea4"><span class="std std-ref">snd_pcm_mmap_begin</span></a><span></span><span class="p">(</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1ga919e634deecd855b6e2e15174e70d3ea"><span class="std std-ref">snd_pcm_t</span></a><span></span><span class="o">*</span> <span class="n">pcm</span><span class="p">,</span>
    <span class="k">const</span> <a class="reference internal" href="struct_snd_pcm_channel_area_t.html#doxid-structsnd-pcm-channel-area-t"><span class="std std-ref">snd_pcm_channel_area_t</span></a><span></span><span class="o">**</span> <span class="n">areas</span><span class="p">,</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1gab01fcfe9b97382a8d3f2027c664b8b8a"><span class="std std-ref">snd_pcm_uframes_t</span></a><span></span><span class="o">*</span> <span class="n">offset</span><span class="p">,</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1gab01fcfe9b97382a8d3f2027c664b8b8a"><span class="std std-ref">snd_pcm_uframes_t</span></a><span></span><span class="o">*</span> <span class="n">frames</span>
<span class="p">);</span>

<a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1ga71cdfa37e258d2210b8bd0216bf0c36c"><span class="std std-ref">snd_pcm_sframes_t</span></a><span></span>
<a class="reference internal" href="#doxid-group-p-c-m-direct-1gac306bd13c305825aa39dd9180a3ad520"><span class="std std-ref">snd_pcm_mmap_commit</span></a><span></span><span class="p">(</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1ga919e634deecd855b6e2e15174e70d3ea"><span class="std std-ref">snd_pcm_t</span></a><span></span><span class="o">*</span> <span class="n">pcm</span><span class="p">,</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1gab01fcfe9b97382a8d3f2027c664b8b8a"><span class="std std-ref">snd_pcm_uframes_t</span></a><span></span> <span class="n">offset</span><span class="p">,</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1gab01fcfe9b97382a8d3f2027c664b8b8a"><span class="std std-ref">snd_pcm_uframes_t</span></a><span></span> <span class="n">frames</span>
<span class="p">);</span>

<a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1ga71cdfa37e258d2210b8bd0216bf0c36c"><span class="std std-ref">snd_pcm_sframes_t</span></a><span></span>
<a class="reference internal" href="#doxid-group-p-c-m-direct-1ga5a9ee8e1e764b12da6d54dfa195f7c52"><span class="std std-ref">snd_pcm_mmap_writei</span></a><span></span><span class="p">(</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1ga919e634deecd855b6e2e15174e70d3ea"><span class="std std-ref">snd_pcm_t</span></a><span></span><span class="o">*</span> <span class="n">pcm</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span> <span class="n">buffer</span><span class="p">,</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1gab01fcfe9b97382a8d3f2027c664b8b8a"><span class="std std-ref">snd_pcm_uframes_t</span></a><span></span> <span class="n">size</span>
<span class="p">);</span>

<a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1ga71cdfa37e258d2210b8bd0216bf0c36c"><span class="std std-ref">snd_pcm_sframes_t</span></a><span></span>
<a class="reference internal" href="#doxid-group-p-c-m-direct-1ga24b6c538c8d7ddd0776ee65f8fb909eb"><span class="std std-ref">snd_pcm_mmap_readi</span></a><span></span><span class="p">(</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1ga919e634deecd855b6e2e15174e70d3ea"><span class="std std-ref">snd_pcm_t</span></a><span></span><span class="o">*</span> <span class="n">pcm</span><span class="p">,</span>
    <span class="kt">void</span><span class="o">*</span> <span class="n">buffer</span><span class="p">,</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1gab01fcfe9b97382a8d3f2027c664b8b8a"><span class="std std-ref">snd_pcm_uframes_t</span></a><span></span> <span class="n">size</span>
<span class="p">);</span>

<a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1ga71cdfa37e258d2210b8bd0216bf0c36c"><span class="std std-ref">snd_pcm_sframes_t</span></a><span></span>
<a class="reference internal" href="#doxid-group-p-c-m-direct-1ga092b1a7f387e9fc2977649bfd43b0958"><span class="std std-ref">snd_pcm_mmap_writen</span></a><span></span><span class="p">(</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1ga919e634deecd855b6e2e15174e70d3ea"><span class="std std-ref">snd_pcm_t</span></a><span></span><span class="o">*</span> <span class="n">pcm</span><span class="p">,</span>
    <span class="kt">void</span><span class="o">**</span> <span class="n">bufs</span><span class="p">,</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1gab01fcfe9b97382a8d3f2027c664b8b8a"><span class="std std-ref">snd_pcm_uframes_t</span></a><span></span> <span class="n">size</span>
<span class="p">);</span>

<a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1ga71cdfa37e258d2210b8bd0216bf0c36c"><span class="std std-ref">snd_pcm_sframes_t</span></a><span></span>
<a class="reference internal" href="#doxid-group-p-c-m-direct-1ga29ce9af60eafb67f0303418a176bf3ea"><span class="std std-ref">snd_pcm_mmap_readn</span></a><span></span><span class="p">(</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1ga919e634deecd855b6e2e15174e70d3ea"><span class="std std-ref">snd_pcm_t</span></a><span></span><span class="o">*</span> <span class="n">pcm</span><span class="p">,</span>
    <span class="kt">void</span><span class="o">**</span> <span class="n">bufs</span><span class="p">,</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1gab01fcfe9b97382a8d3f2027c664b8b8a"><span class="std std-ref">snd_pcm_uframes_t</span></a><span></span> <span class="n">size</span>
<span class="p">);</span></pre>
</section>
<section id="detailed-documentation">
<span id="details-group-p-c-m-direct"></span><h2>Detailed Documentation</h2>
<p>See the <a class="reference internal" href="page_pcm.html#doxid-pcm"><span class="std std-ref">PCM (digital audio) interface</span></a> page for more details.</p>
<section id="global-functions">
<h3>Global Functions</h3>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-group-p-c-m-direct-1ga6d4acf42de554d4d1177fb035d484ea4"><span id="index-1"></span><span></span><span class="kt">int</span>
<span class="n">snd_pcm_mmap_begin</span><span class="p">(</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1ga919e634deecd855b6e2e15174e70d3ea"><span class="std std-ref">snd_pcm_t</span></a><span></span><span class="o">*</span> <span class="n">pcm</span><span class="p">,</span>
    <span class="k">const</span> <a class="reference internal" href="struct_snd_pcm_channel_area_t.html#doxid-structsnd-pcm-channel-area-t"><span class="std std-ref">snd_pcm_channel_area_t</span></a><span></span><span class="o">**</span> <span class="n">areas</span><span class="p">,</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1gab01fcfe9b97382a8d3f2027c664b8b8a"><span class="std std-ref">snd_pcm_uframes_t</span></a><span></span><span class="o">*</span> <span class="n">offset</span><span class="p">,</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1gab01fcfe9b97382a8d3f2027c664b8b8a"><span class="std std-ref">snd_pcm_uframes_t</span></a><span></span><span class="o">*</span> <span class="n">frames</span>
<span class="p">)</span></pre>
<p>Application request to access a portion of direct (mmap) area.</p>
<p>It is necessary to call the <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1ga8bb836bd0c414b59789d51a5f5379c08"><span class="std std-ref">snd_pcm_avail_update()</span></a> function directly before this call. Otherwise, this function can return a wrong count of available frames.</p>
<p>The function should be called before a sample-direct area can be accessed. The resulting size parameter is always less or equal to the input count of frames and can be zero, if no frames can be processed (the ring buffer is full).</p>
<p>See the <a class="reference internal" href="#doxid-group-p-c-m-direct-1gac306bd13c305825aa39dd9180a3ad520"><span class="std std-ref">snd_pcm_mmap_commit()</span></a> function to finish the frame processing in the direct areas.</p>
<p>The function is thread-safe when built with the proper option.</p>
<p class="rubric">Parameters:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>pcm</p></td>
<td><p>PCM handle</p></td>
</tr>
<tr class="row-even"><td><p>areas</p></td>
<td><p>Returned mmap channel areas</p></td>
</tr>
<tr class="row-odd"><td><p>offset</p></td>
<td><p>Returned mmap area offset in area steps (== frames)</p></td>
</tr>
<tr class="row-even"><td><p>frames</p></td>
<td><p>mmap area portion size in frames (wanted on entry, contiguous available on exit)</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Returns:</p>
<p>0 on success otherwise a negative error code</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-group-p-c-m-direct-1gac306bd13c305825aa39dd9180a3ad520"><span id="index-2"></span><a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1ga71cdfa37e258d2210b8bd0216bf0c36c"><span class="std std-ref">snd_pcm_sframes_t</span></a><span></span>
<span class="n">snd_pcm_mmap_commit</span><span class="p">(</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1ga919e634deecd855b6e2e15174e70d3ea"><span class="std std-ref">snd_pcm_t</span></a><span></span><span class="o">*</span> <span class="n">pcm</span><span class="p">,</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1gab01fcfe9b97382a8d3f2027c664b8b8a"><span class="std std-ref">snd_pcm_uframes_t</span></a><span></span> <span class="n">offset</span><span class="p">,</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1gab01fcfe9b97382a8d3f2027c664b8b8a"><span class="std std-ref">snd_pcm_uframes_t</span></a><span></span> <span class="n">frames</span>
<span class="p">)</span></pre>
<p>Application has completed the access to area requested with <a class="reference internal" href="#doxid-group-p-c-m-direct-1ga6d4acf42de554d4d1177fb035d484ea4"><span class="std std-ref">snd_pcm_mmap_begin</span></a>.</p>
<p>You should pass this function the offset value that <a class="reference internal" href="#doxid-group-p-c-m-direct-1ga6d4acf42de554d4d1177fb035d484ea4"><span class="std std-ref">snd_pcm_mmap_begin()</span></a> returned. The frames parameter should hold the number of frames you have written or read to/from the audio buffer. The frames parameter must never exceed the contiguous frames count that <a class="reference internal" href="#doxid-group-p-c-m-direct-1ga6d4acf42de554d4d1177fb035d484ea4"><span class="std std-ref">snd_pcm_mmap_begin()</span></a> returned. Each call to <a class="reference internal" href="#doxid-group-p-c-m-direct-1ga6d4acf42de554d4d1177fb035d484ea4"><span class="std std-ref">snd_pcm_mmap_begin()</span></a> must be followed by a call to <a class="reference internal" href="#doxid-group-p-c-m-direct-1gac306bd13c305825aa39dd9180a3ad520"><span class="std std-ref">snd_pcm_mmap_commit()</span></a>.</p>
<p>Example:</p>
<pre class="highlight literal-block"><span></span> <span class="kt">double</span> <span class="n">phase</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
 <span class="k">const</span> <span class="n">snd_pcm_area_t</span> <span class="o">*</span><span class="n">areas</span><span class="p">;</span>
 <span class="n">snd_pcm_sframes_t</span> <span class="n">avail</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">commitres</span><span class="p">;</span>
 <span class="n">snd_pcm_uframes_t</span> <span class="n">offset</span><span class="p">,</span> <span class="n">frames</span><span class="p">;</span>
 <span class="kt">int</span> <span class="n">err</span><span class="p">;</span>

 <span class="n">avail</span> <span class="o">=</span> <span class="n">snd_pcm_avail_update</span><span class="p">(</span><span class="n">pcm</span><span class="p">);</span>
 <span class="k">if</span> <span class="p">(</span><span class="n">avail</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
   <span class="n">error</span><span class="p">(</span><span class="n">avail</span><span class="p">);</span>
 <span class="c1">// at this point, we can transfer at least &#39;avail&#39; frames</span>

 <span class="c1">// we want to process frames in chunks (period_size)</span>
 <span class="k">if</span> <span class="p">(</span><span class="n">avail</span> <span class="o">&lt;</span> <span class="n">period_size</span><span class="p">)</span>
   <span class="k">goto</span> <span class="n">_skip</span><span class="p">;</span>
 <span class="n">size</span> <span class="o">=</span> <span class="n">period_size</span><span class="p">;</span>
 <span class="c1">// it is possible that contiguous areas are smaller, thus we use a loop</span>
 <span class="k">while</span> <span class="p">(</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
   <span class="n">frames</span> <span class="o">=</span> <span class="n">size</span><span class="p">;</span>

   <span class="n">err</span> <span class="o">=</span> <span class="n">snd_pcm_mmap_begin</span><span class="p">(</span><span class="n">pcm_handle</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">areas</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">offset</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">frames</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
     <span class="n">error</span><span class="p">(</span><span class="n">err</span><span class="p">);</span>
   <span class="c1">// this function fills the areas from offset with count of frames</span>
   <span class="n">generate_sine</span><span class="p">(</span><span class="n">areas</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">frames</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">phase</span><span class="p">);</span>
   <span class="n">commitres</span> <span class="o">=</span> <span class="n">snd_pcm_mmap_commit</span><span class="p">(</span><span class="n">pcm_handle</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">frames</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">commitres</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">commitres</span> <span class="o">!=</span> <span class="n">frames</span><span class="p">)</span>
     <span class="n">error</span><span class="p">(</span><span class="n">commitres</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">?</span> <span class="o">-</span><span class="nl">EPIPE</span> <span class="p">:</span> <span class="n">commitres</span><span class="p">);</span>

   <span class="n">size</span> <span class="o">-=</span> <span class="n">frames</span><span class="p">;</span>
 <span class="p">}</span>
<span class="nl">_skip</span><span class="p">:</span></pre>
<p>Look to the <a class="reference internal" href="page_pcm.html#doxid-pcm-1example-test-pcm"><span class="std std-ref">Sine-wave generator</span></a> example for more details about the generate_sine function.</p>
<p>The function is thread-safe when built with the proper option.</p>
<p class="rubric">Parameters:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>pcm</p></td>
<td><p>PCM handle</p></td>
</tr>
<tr class="row-even"><td><p>offset</p></td>
<td><p>area offset in area steps (== frames)</p></td>
</tr>
<tr class="row-odd"><td><p>frames</p></td>
<td><p>area portion size in frames</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Returns:</p>
<p>count of transferred frames otherwise a negative error code</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-group-p-c-m-direct-1ga5a9ee8e1e764b12da6d54dfa195f7c52"><span id="index-3"></span><a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1ga71cdfa37e258d2210b8bd0216bf0c36c"><span class="std std-ref">snd_pcm_sframes_t</span></a><span></span>
<span class="n">snd_pcm_mmap_writei</span><span class="p">(</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1ga919e634deecd855b6e2e15174e70d3ea"><span class="std std-ref">snd_pcm_t</span></a><span></span><span class="o">*</span> <span class="n">pcm</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span> <span class="n">buffer</span><span class="p">,</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1gab01fcfe9b97382a8d3f2027c664b8b8a"><span class="std std-ref">snd_pcm_uframes_t</span></a><span></span> <span class="n">size</span>
<span class="p">)</span></pre>
<p>Write interleaved frames to a PCM using direct buffer (mmap)</p>
<p>If the blocking behaviour is selected, then routine waits until all requested bytes are played or put to the playback ring buffer. The count of bytes can be less only if a signal or underrun occurred.</p>
<p>If the non-blocking behaviour is selected, then routine doesn’t wait at all.</p>
<p class="rubric">Parameters:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>pcm</p></td>
<td><p>PCM handle</p></td>
</tr>
<tr class="row-even"><td><p>buffer</p></td>
<td><p>frames containing buffer</p></td>
</tr>
<tr class="row-odd"><td><p>size</p></td>
<td><p>frames to be written</p></td>
</tr>
<tr class="row-even"><td><p>-EBADFD</p></td>
<td><p>PCM is not in the right state (<a class="reference internal" href="enum_snd_pcm_state_t.html#doxid-group-p-c-m-1gga61ac499cb3701ce536d4d83725908860a3eb4a3b75c7d2adb22f1829f3f738b27"><span class="std std-ref">SND_PCM_STATE_PREPARED</span></a> or <a class="reference internal" href="enum_snd_pcm_state_t.html#doxid-group-p-c-m-1gga61ac499cb3701ce536d4d83725908860a86f6fbc796881f19fde0e1957f878147"><span class="std std-ref">SND_PCM_STATE_RUNNING</span></a>)</p></td>
</tr>
<tr class="row-odd"><td><p>-EPIPE</p></td>
<td><p>an underrun occurred</p></td>
</tr>
<tr class="row-even"><td><p>-ESTRPIPE</p></td>
<td><p>a suspend event occurred (stream is suspended and waiting for an application recovery)</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Returns:</p>
<p>a positive number of frames actually written otherwise a negative error code</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-group-p-c-m-direct-1ga24b6c538c8d7ddd0776ee65f8fb909eb"><span id="index-4"></span><a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1ga71cdfa37e258d2210b8bd0216bf0c36c"><span class="std std-ref">snd_pcm_sframes_t</span></a><span></span>
<span class="n">snd_pcm_mmap_readi</span><span class="p">(</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1ga919e634deecd855b6e2e15174e70d3ea"><span class="std std-ref">snd_pcm_t</span></a><span></span><span class="o">*</span> <span class="n">pcm</span><span class="p">,</span>
    <span class="kt">void</span><span class="o">*</span> <span class="n">buffer</span><span class="p">,</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1gab01fcfe9b97382a8d3f2027c664b8b8a"><span class="std std-ref">snd_pcm_uframes_t</span></a><span></span> <span class="n">size</span>
<span class="p">)</span></pre>
<p>Read interleaved frames from a PCM using direct buffer (mmap)</p>
<p>If the blocking behaviour was selected, then routine waits until all requested bytes are filled. The count of bytes can be less only if a signal or underrun occurred.</p>
<p>If the non-blocking behaviour is selected, then routine doesn’t wait at all.</p>
<p class="rubric">Parameters:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>pcm</p></td>
<td><p>PCM handle</p></td>
</tr>
<tr class="row-even"><td><p>buffer</p></td>
<td><p>frames containing buffer</p></td>
</tr>
<tr class="row-odd"><td><p>size</p></td>
<td><p>frames to be written</p></td>
</tr>
<tr class="row-even"><td><p>-EBADFD</p></td>
<td><p>PCM is not in the right state (<a class="reference internal" href="enum_snd_pcm_state_t.html#doxid-group-p-c-m-1gga61ac499cb3701ce536d4d83725908860a3eb4a3b75c7d2adb22f1829f3f738b27"><span class="std std-ref">SND_PCM_STATE_PREPARED</span></a> or <a class="reference internal" href="enum_snd_pcm_state_t.html#doxid-group-p-c-m-1gga61ac499cb3701ce536d4d83725908860a86f6fbc796881f19fde0e1957f878147"><span class="std std-ref">SND_PCM_STATE_RUNNING</span></a>)</p></td>
</tr>
<tr class="row-odd"><td><p>-EPIPE</p></td>
<td><p>an overrun occurred</p></td>
</tr>
<tr class="row-even"><td><p>-ESTRPIPE</p></td>
<td><p>a suspend event occurred (stream is suspended and waiting for an application recovery)</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Returns:</p>
<p>a positive number of frames actually read otherwise a negative error code</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-group-p-c-m-direct-1ga092b1a7f387e9fc2977649bfd43b0958"><span id="index-5"></span><a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1ga71cdfa37e258d2210b8bd0216bf0c36c"><span class="std std-ref">snd_pcm_sframes_t</span></a><span></span>
<span class="n">snd_pcm_mmap_writen</span><span class="p">(</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1ga919e634deecd855b6e2e15174e70d3ea"><span class="std std-ref">snd_pcm_t</span></a><span></span><span class="o">*</span> <span class="n">pcm</span><span class="p">,</span>
    <span class="kt">void</span><span class="o">**</span> <span class="n">bufs</span><span class="p">,</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1gab01fcfe9b97382a8d3f2027c664b8b8a"><span class="std std-ref">snd_pcm_uframes_t</span></a><span></span> <span class="n">size</span>
<span class="p">)</span></pre>
<p>Write non interleaved frames to a PCM using direct buffer (mmap)</p>
<p>If the blocking behaviour is selected, then routine waits until all requested bytes are played or put to the playback ring buffer. The count of bytes can be less only if a signal or underrun occurred.</p>
<p>If the non-blocking behaviour is selected, then routine doesn’t wait at all.</p>
<p class="rubric">Parameters:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>pcm</p></td>
<td><p>PCM handle</p></td>
</tr>
<tr class="row-even"><td><p>bufs</p></td>
<td><p>frames containing buffers (one for each channel)</p></td>
</tr>
<tr class="row-odd"><td><p>size</p></td>
<td><p>frames to be written</p></td>
</tr>
<tr class="row-even"><td><p>-EBADFD</p></td>
<td><p>PCM is not in the right state (<a class="reference internal" href="enum_snd_pcm_state_t.html#doxid-group-p-c-m-1gga61ac499cb3701ce536d4d83725908860a3eb4a3b75c7d2adb22f1829f3f738b27"><span class="std std-ref">SND_PCM_STATE_PREPARED</span></a> or <a class="reference internal" href="enum_snd_pcm_state_t.html#doxid-group-p-c-m-1gga61ac499cb3701ce536d4d83725908860a86f6fbc796881f19fde0e1957f878147"><span class="std std-ref">SND_PCM_STATE_RUNNING</span></a>)</p></td>
</tr>
<tr class="row-odd"><td><p>-EPIPE</p></td>
<td><p>an underrun occurred</p></td>
</tr>
<tr class="row-even"><td><p>-ESTRPIPE</p></td>
<td><p>a suspend event occurred (stream is suspended and waiting for an application recovery)</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Returns:</p>
<p>a positive number of frames actually written otherwise a negative error code</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-group-p-c-m-direct-1ga29ce9af60eafb67f0303418a176bf3ea"><span id="index-6"></span><a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1ga71cdfa37e258d2210b8bd0216bf0c36c"><span class="std std-ref">snd_pcm_sframes_t</span></a><span></span>
<span class="n">snd_pcm_mmap_readn</span><span class="p">(</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1ga919e634deecd855b6e2e15174e70d3ea"><span class="std std-ref">snd_pcm_t</span></a><span></span><span class="o">*</span> <span class="n">pcm</span><span class="p">,</span>
    <span class="kt">void</span><span class="o">**</span> <span class="n">bufs</span><span class="p">,</span>
    <a class="reference internal" href="group_PCM.html#doxid-group-p-c-m-1gab01fcfe9b97382a8d3f2027c664b8b8a"><span class="std std-ref">snd_pcm_uframes_t</span></a><span></span> <span class="n">size</span>
<span class="p">)</span></pre>
<p>Read non interleaved frames to a PCM using direct buffer (mmap)</p>
<p>If the blocking behaviour was selected, then routine waits until all requested bytes are filled. The count of bytes can be less only if a signal or underrun occurred.</p>
<p>If the non-blocking behaviour is selected, then routine doesn’t wait at all.</p>
<p class="rubric">Parameters:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>pcm</p></td>
<td><p>PCM handle</p></td>
</tr>
<tr class="row-even"><td><p>bufs</p></td>
<td><p>frames containing buffers (one for each channel)</p></td>
</tr>
<tr class="row-odd"><td><p>size</p></td>
<td><p>frames to be written</p></td>
</tr>
<tr class="row-even"><td><p>-EBADFD</p></td>
<td><p>PCM is not in the right state (<a class="reference internal" href="enum_snd_pcm_state_t.html#doxid-group-p-c-m-1gga61ac499cb3701ce536d4d83725908860a3eb4a3b75c7d2adb22f1829f3f738b27"><span class="std std-ref">SND_PCM_STATE_PREPARED</span></a> or <a class="reference internal" href="enum_snd_pcm_state_t.html#doxid-group-p-c-m-1gga61ac499cb3701ce536d4d83725908860a86f6fbc796881f19fde0e1957f878147"><span class="std std-ref">SND_PCM_STATE_RUNNING</span></a>)</p></td>
</tr>
<tr class="row-odd"><td><p>-EPIPE</p></td>
<td><p>an overrun occurred</p></td>
</tr>
<tr class="row-even"><td><p>-ESTRPIPE</p></td>
<td><p>a suspend event occurred (stream is suspended and waiting for an application recovery)</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Returns:</p>
<p>a positive number of frames actually read otherwise a negative error code</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="group_PCM_Description.html" class="btn btn-neutral float-left" title="Description Functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="group_PCM_Format.html" class="btn btn-neutral float-right" title="Format Mask Functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 1998-2017, ALSA Library Maintainers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>