.. index:: pair: group; The SSH buffer functions.
.. _doxid-group__libssh__buffer:

The SSH buffer functions.
=========================

.. toctree::
	:hidden:

Overview
~~~~~~~~

Functions to handle SSH buffers. :ref:`More...<details-group__libssh__buffer>`


.. ref-code-block:: cpp
	:class: doxyrest-overview-code-block

	
	// global functions

	:ref:`LIBSSH_API<doxid-libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5>` ssh_buffer
	:ref:`ssh_buffer_new<doxid-group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b>`(void);

	void
	:ref:`ssh_buffer_set_secure<doxid-group__libssh__buffer_1gade0108b17f43b5269b92456a785df126>`(ssh_buffer buffer);

	int
	:ref:`ssh_buffer_validate_length<doxid-group__libssh__buffer_1ga49d552059803b03f1c305619cba34e24>`(
		struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer,
		size_t len
	);

	int
	:target:`_ssh_buffer_pack<doxid-group__libssh__buffer_1ga4753c89b03284ed283ec1a76f24207ea>`(
		struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer,
		const char* format,
		int argc,
		...
	);

	int
	:target:`_ssh_buffer_unpack<doxid-group__libssh__buffer_1ga52d492186c8e43e55e83dcca264ff393>`(
		struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer,
		const char* format,
		int argc,
		...
	);

	int
	:target:`buffer_add_buffer<doxid-group__libssh__buffer_1gae22fadbeb000c794bb897590f934a6eb>`(
		struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer,
		struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* source
	);

	int
	:target:`buffer_add_ssh_string<doxid-group__libssh__buffer_1ga0172920552b64c007420ee49a3f66ee1>`(
		struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer,
		struct :ref:`ssh_string_struct<doxid-structssh__string__struct>`* string
	);

	int
	:target:`buffer_add_u16<doxid-group__libssh__buffer_1ga1f7030920ecf0c2c4b57f59bb401df64>`(
		struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer,
		uint16_t data
	);

	int
	:target:`buffer_add_u32<doxid-group__libssh__buffer_1ga4328773bddf5ecf457fa50c8b68795e6>`(
		struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer,
		uint32_t data
	);

	int
	:target:`buffer_add_u64<doxid-group__libssh__buffer_1gae63f52db631a7b2f5d2483b9c730aa31>`(
		struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer,
		uint64_t data
	);

	int
	:target:`buffer_add_u8<doxid-group__libssh__buffer_1gaa14ac0656ee7159a9f1c27e60a3e2ca0>`(
		struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer,
		uint8_t data
	);

	uint32_t
	:target:`buffer_get_data<doxid-group__libssh__buffer_1gaef11649dcb6769596c372ff227f53a1c>`(
		struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer,
		void* data,
		uint32_t len
	);

	struct :ref:`ssh_string_struct<doxid-structssh__string__struct>`*
	:target:`buffer_get_mpint<doxid-group__libssh__buffer_1ga5735c025b24e68425533e018320b0419>`(struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer);

	void*
	:target:`buffer_get_rest<doxid-group__libssh__buffer_1gad338327b55db724fc135155b6ac191fd>`(struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer);

	uint32_t
	:target:`buffer_get_rest_len<doxid-group__libssh__buffer_1ga12c1bc319d0117da2b6100f46ab96194>`(struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer);

	struct :ref:`ssh_string_struct<doxid-structssh__string__struct>`*
	:target:`buffer_get_ssh_string<doxid-group__libssh__buffer_1ga208f7cc2f69191c717d4bfd5d153bca4>`(struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer);

	int
	:target:`buffer_get_u32<doxid-group__libssh__buffer_1gaa61548111c58d5c25d8971206ab71327>`(
		struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer,
		uint32_t* data
	);

	int
	:target:`buffer_get_u64<doxid-group__libssh__buffer_1gafa1b6c43c99f25cc914f4ac884c590f8>`(
		struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer,
		uint64_t* data
	);

	int
	:target:`buffer_get_u8<doxid-group__libssh__buffer_1gab30280cc6f9c061968567dd84a1fad15>`(
		struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer,
		uint8_t* data
	);

	uint32_t
	:target:`buffer_pass_bytes<doxid-group__libssh__buffer_1ga7537345795760271eaece2a0e2c94076>`(
		struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer,
		uint32_t len
	);

	uint32_t
	:target:`buffer_pass_bytes_end<doxid-group__libssh__buffer_1gaba8b7bcdf3e991afe95e9468b3981f3b>`(
		struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer,
		uint32_t len
	);

	int
	:target:`buffer_prepend_data<doxid-group__libssh__buffer_1ga2341f0b8f10974bf19f875a2e8408319>`(
		struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer,
		const void* data,
		uint32_t len
	);

	static
	void
	:target:`buffer_shift<doxid-group__libssh__buffer_1gae0e221aeee158e4762f95207c7f31a68>`(ssh_buffer buffer);

	static
	int
	:target:`realloc_buffer<doxid-group__libssh__buffer_1ga66ac61dc075863462b8d83b65660e7df>`(
		struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer,
		size_t needed
	);

	int
	:target:`ssh_buffer_add_data<doxid-group__libssh__buffer_1ga3bf82f0f310311432410f9393ebab528>`(
		struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer,
		const void* data,
		uint32_t len
	);

	void
	:ref:`ssh_buffer_free<doxid-group__libssh__buffer_1ga608cf73226454f21e8b2f9f1d838c5fc>`(struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer);

	void*
	:ref:`ssh_buffer_get_begin<doxid-group__libssh__buffer_1ga4e6c650c6361809182bc2fa4e0cde982>`(struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer);

	uint32_t
	:ref:`ssh_buffer_get_len<doxid-group__libssh__buffer_1gad1594908ed57799f4a84066f47c3e7c0>`(struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer);

	int
	:target:`ssh_buffer_pack_va<doxid-group__libssh__buffer_1gad1efe410944c255ab4a640f2e04871fc>`(
		struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer,
		const char* format,
		int argc,
		va_list ap
	);

	int
	:target:`ssh_buffer_reinit<doxid-group__libssh__buffer_1gad877da63fd8d9a0ee00859bfbacf1eda>`(struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer);

	int
	:target:`ssh_buffer_unpack_va<doxid-group__libssh__buffer_1ga141f7ae3d689f9f28eaa307e50c4aa41>`(
		struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer,
		const char* format,
		int argc,
		va_list ap
	);

	// macros

	#define :target:`buffer_verify<doxid-group__libssh__buffer_1gaad7d3655d5c5c31bc67fe9f1b9ba6a7a>`(x)

.. _details-group__libssh__buffer:

Detailed Documentation
~~~~~~~~~~~~~~~~~~~~~~

Functions to handle SSH buffers.

Global Functions
----------------

.. index:: pair: function; ssh_buffer_new
.. _doxid-group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`LIBSSH_API<doxid-libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5>` ssh_buffer
	ssh_buffer_new(void)

Create a new SSH buffer.



.. rubric:: Returns:

A newly initialized SSH buffer, NULL on error.

.. index:: pair: function; ssh_buffer_set_secure
.. _doxid-group__libssh__buffer_1gade0108b17f43b5269b92456a785df126:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	ssh_buffer_set_secure(ssh_buffer buffer)

Sets the buffer as secure.

A secure buffer will never leave cleartext data in the heap after being reallocated or freed.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- buffer

		- buffer to set secure.

.. index:: pair: function; ssh_buffer_validate_length
.. _doxid-group__libssh__buffer_1ga49d552059803b03f1c305619cba34e24:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	int
	ssh_buffer_validate_length(
		struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer,
		size_t len
	)

Valdiates that the given length can be obtained from the buffer.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- buffer

		- The buffer to read from.

	*
		- len

		- The length to be checked.



.. rubric:: Returns:

SSH_OK if the length is valid, SSH_ERROR otherwise.

.. index:: pair: function; ssh_buffer_free
.. _doxid-group__libssh__buffer_1ga608cf73226454f21e8b2f9f1d838c5fc:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	ssh_buffer_free(struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer)

Deallocate a SSH buffer.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- buffer

		- The buffer to free.

.. index:: pair: function; ssh_buffer_get_begin
.. _doxid-group__libssh__buffer_1ga4e6c650c6361809182bc2fa4e0cde982:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void*
	ssh_buffer_get_begin(struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer)

Get a pointer on the head of a buffer.

.. warning::

	Don't expect data to be nul-terminated.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- buffer

		- The buffer to get the head pointer.



.. rubric:: Returns:

A data pointer on the head. It doesn't take the position into account.



.. rubric:: See also:

:ref:`buffer_get_rest() <doxid-group__libssh__buffer_1gad338327b55db724fc135155b6ac191fd>`

:ref:`buffer_get_len() <doxid-legacy_8h_1aa0cd1cfbd77a218c13583c23a11e0d22>`

.. index:: pair: function; ssh_buffer_get_len
.. _doxid-group__libssh__buffer_1gad1594908ed57799f4a84066f47c3e7c0:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	uint32_t
	ssh_buffer_get_len(struct :ref:`ssh_buffer_struct<doxid-structssh__buffer__struct>`* buffer)

Get the length of the buffer, not counting position.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- buffer

		- The buffer to get the length from.



.. rubric:: Returns:

The length of the buffer.



.. rubric:: See also:

:ref:`buffer_get() <doxid-legacy_8h_1aef9ac9378dc7bfe3e3c3f7c55e5a98f5>`

